<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:cc="http://java.sun.com/jsf/composite/components"
                xmlns:sec="http://www.springframework.org/security/tags"
                template="/templates/main.xhtml">
    <ui:define name="title">
        <cc:titleText title="#{msg['pos']['schemeTableColumn']}"/>
    </ui:define>
    <ui:define name="content">
        <style>
            .schemeTableColumnDataTable table tbody td {
                white-space: normal;
                word-wrap: break-word;
            }
        </style>
        <script>
            function checkElementSelection() {
                if (PF('schemeTableColumnDataTableVar').selection.length == 0) {
                    PF('infoDialog').show();
                    return false;
                } else {
                    return true;
                }
            }
        </script>
        <h:form id="schemeTableColumnDataTableForm">
            <p:panel header="#{msg['common']['search']}" style="width: 100%;">
                <div class="ui-grid ui-grid-responsive">
                    <div class="ui-grid-row">
                        <div class="ui-grid-col-8">
                            <h:outputLabel for="name" value="#{msg['pos']['fromColumn']}"/>
                            <p:inputText id="name"
                                         value="#{schemeTableColumnController.dataModel.dataModelQuery.criteria.fromColumnKeyword}"
                                         label="#{msg['common']['name']}" maxlength="100"
                                         style="width: 164px;"/>
                            <p:commandButton id="searchButton"
                                             value="#{msg['common']['search']}"
                                             update="schemeTableColumnDataTable" icon="ui-icon-search1"
                                             style=" margin-left: 10px;"/>
                        </div>
                    </div>

                </div>
            </p:panel>
            <cc:spacer/>
            <p:toolbar id="toolbar">
                <p:toolbarGroup align="left">
                    <p:commandButton id="addBtn" value="#{msg['common']['add']}"
                                     process="@this" action="#{schemeTableColumnController.add}"
                                     update=":schemeTableColumnDialogForm"
                                     oncomplete="PF('schemeTableColumnDialogVar').show();"
                                     icon="ui-icon-add"/>
                    <p:commandButton id="editBtn" value="#{msg['common']['edit']}"
                                     process="@form"
                                     update=":schemeTableColumnDialogForm"
                                     oncomplete="PF('schemeTableColumnDialogVar').show();" icon="ui-icon-edit"
                                     onclick="if (!checkDatatableSelection('schemeTableColumnDataTableVar')) return false;"/>
                    <p:commandButton id="deleteBtn"
                                     value="#{msg['common']['delete']}" process="@form"
                                     action="#{schemeTableColumnController.delete}"
                                     update=":schemeTableColumnDataTableForm:schemeTableColumnDataTable"
                                     icon="ui-icon-delete"
                                     onclick="if (!confirmDeleteDatatableRecord('schemeTableColumnDataTableVar')) return false;"
                                     rendered="#{commonController.loginUser.isAdmin()}"/>
                </p:toolbarGroup>
            </p:toolbar>
            <cc:spacer height="3"/>
            <p:dataTable id="schemeTableColumnDataTable" styleClass="schemeTableColumnDataTable"
                         widgetVar="schemeTableColumnDataTableVar" var="element"
                         value="#{schemeTableColumnController.dataModel}"
                         selection="#{schemeTableColumnController.schemeTableColumn}"
                         paginator="true"
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="15" rows="15" lazy="true" dynamic="true"
                         emptyMessage="#{msg['common']['noRecord']}" rowKey="#{element.id}">

                <f:facet name="header">
                    <p:graphicImage value="/images/record16.png"/>
                    <h:outputText value="#{msg['pos']['schemeTableColumn']}"/>
                </f:facet>
                <p:column selectionMode="single" style="width:16px; text-align:center"/>
                <p:column headerText="#{msg['pos']['seq']}">
                    <h:outputText value="#{element.seq}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['fromColumn']}">
                    <h:outputText value="#{element.fromColumn}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['fromColumnFormat']}">
                    <h:outputText value="#{element.fromColumnFormat}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['fromColumnLength']}">
                    <h:outputText value="#{element.fromColumnLength}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['toColumn']}">
                    <h:outputText value="#{element.toColumn}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['toColumnFormat']}">
                    <h:outputText value="#{element.toColumnFormat}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['toColumnLength']}">
                    <h:outputText value="#{element.toColumnLength}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['fromColumnPrecision']}">
                    <h:outputText value="#{element.fromColumnPrecision}"/>
                </p:column>
                <p:column headerText="#{msg['pos']['toColumnPrecision']}">
                    <h:outputText value="#{element.toColumnPrecision}"/>
                </p:column>
            </p:dataTable>
        </h:form>

    </ui:define>
    <ui:define name="dialog">
        <p:dialog id="schemeTableColumnDialog"
                  widgetVar="schemeTableColumnDialogVar" modal="true" width="600"
                  resizable="false">
            <f:facet name="header">
                <p:graphicImage value="/images/element16.png"/>
                <h:outputText value="#{msg['pos']['schemeTableColumn']} #{msg['pos']['detail']}"/>
            </f:facet>
            <h:form id="schemeTableColumnDialogForm">

                <h:panelGrid id="formPanel" columns="2"
                             columnClasses="panel-grid-col1,panel-grid-col2" cellpadding="5" style="width: 100%;"
                             rendered="#{schemeTableColumnController.schemeTableColumn != null}">
                    <h:outputLabel for="seq" value="#{msg['pos']['seq']}"/>
                    <p:inputText id="seq" value="#{schemeTableColumnController.schemeTableColumn.seq}"
                                 style="width: 95%"/>
                    <h:outputLabel for="fromColumn" value="#{msg['pos']['fromColumn']}"/>
                    <p:inputText id="fromColumn" value="#{schemeTableColumnController.schemeTableColumn.fromColumn}"
                                 style="width: 95%"/>
                    <h:outputLabel for="fromColumnFormat" value="#{msg['pos']['fromColumnFormat']}"/>
                    <p:inputText id="fromColumnFormat"
                                 value="#{schemeTableColumnController.schemeTableColumn.fromColumnFormat}"
                                 style="width: 95%"/>
                    <h:outputLabel for="fromColumnLength" value="#{msg['pos']['fromColumnLength']}"/>
                    <p:inputText id="fromColumnLength"
                                 value="#{schemeTableColumnController.schemeTableColumn.fromColumnLength}"
                                 style="width: 95%"/>
                    <h:outputLabel for="toColumn" value="#{msg['pos']['toColumn']}"/>
                    <p:inputText id="toColumn" value="#{schemeTableColumnController.schemeTableColumn.toColumn}"
                                 style="width: 95%"/>
                    <h:outputLabel for="toColumnFormat" value="#{msg['pos']['toColumnFormat']}"/>
                    <p:inputText id="toColumnFormat"
                                 value="#{schemeTableColumnController.schemeTableColumn.toColumnFormat}"
                                 style="width: 95%"/>
                    <h:outputLabel for="toColumnLength" value="#{msg['pos']['toColumnLength']}"/>
                    <p:inputText id="toColumnLength"
                                 value="#{schemeTableColumnController.schemeTableColumn.toColumnLength}"
                                 style="width: 95%"/>
                    <h:outputLabel for="fromColumnPrecision" value="#{msg['pos']['fromColumnPrecision']}"/>
                    <p:inputText id="fromColumnPrecision"
                                 value="#{schemeTableColumnController.schemeTableColumn.fromColumnPrecision}"
                                 style="width: 95%"/>
                    <h:outputLabel for="toColumnPrecision" value="#{msg['pos']['toColumnPrecision']}"/>
                    <p:inputText id="toColumnPrecision"
                                 value="#{schemeTableColumnController.schemeTableColumn.toColumnPrecision}"
                                 style="width: 95%"/>
                    <p:spacer/>
                    <h:panelGroup style="width: 95%; display: inline-block; text-align: right;">
                        <p:commandButton id="submitButton" value="#{msg['common']['save']}"
                                         actionListener="#{schemeTableColumnController.save}"
                                         update="@form :schemeTableColumnDataTableForm :primefaceMessages"
                                         oncomplete="handleComplete(xhr, status, args)"
                                         icon="ui-icon-save1" style=" margin-right: -7px;"/>
                    </h:panelGroup>
                </h:panelGrid>
            </h:form>
        </p:dialog>
        <script type="text/javascript">
            function handleComplete(xhr, status, args) {
                if (args.validationFailed) {
                    PF('schemeTableColumnDialogVar').jq.effect("shake", {
                        times: 3
                    }, 100);
                } else {
                    PF('schemeTableColumnDialogVar').hide();
                }
            }
            $(document).bind("keyup", function (evt) {
                if (27 == evt.keyCode) {
                    PF('schemeTableColumnDialogVar').hide();
                }
            });
        </script>
    </ui:define>
</ui:composition>
