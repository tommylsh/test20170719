package com.maxim.pos.rest;

import com.maxim.exception.BaseException;
import com.maxim.pos.rest.resource.MasterResource;
import org.glassfish.jersey.jackson.JacksonFeature;
import org.glassfish.jersey.message.GZipEncoder;
import org.glassfish.jersey.message.MessageProperties;
import org.glassfish.jersey.message.filtering.EntityFilteringFeature;
import org.glassfish.jersey.server.ResourceConfig;
import org.glassfish.jersey.server.filter.EncodingFilter;
import org.glassfish.jersey.server.spring.scope.RequestContextFilter;

/**
 * Registers the components to be used by the JAX-RS application
 */
public class RestApplication extends ResourceConfig {

    public RestApplication() {

        packages(MasterResource.class.getPackage().getName());
        packages(BaseException.class.getPackage().getName());

        property(MessageProperties.XML_SECURITY_DISABLE, Boolean.TRUE);

        // register filters
        register(RequestContextFilter.class);

        // register exception mappers
        register(AppExceptionMapper.class);

        // register features
        register(JacksonFeature.class);
        // register(JacksonResolver.class);
        register(EntityFilteringFeature.class);

        EncodingFilter.enableFor(this, GZipEncoder.class);

    }

}
