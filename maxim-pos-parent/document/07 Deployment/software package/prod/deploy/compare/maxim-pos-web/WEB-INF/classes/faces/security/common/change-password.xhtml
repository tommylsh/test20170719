<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:cc="http://java.sun.com/jsf/composite/components"
	xmlns:sec="http://www.springframework.org/security/tags"
	template="/templates/main.xhtml">

	<ui:define name="title">
		<cc:titleText title="#{msg['security']['updatePassword']}" />
	</ui:define>

	<ui:define name="content">
		<p:growl id="messages" showDetail="true"></p:growl>
		<p:panel style="width: 300px;">
			<f:facet name="header">
				<p:graphicImage value="/images/element16.png" />
				<h:outputText value="#{msg['security']['updatePassword']}" />
			</f:facet>
			<h:form id="form">
				<h:panelGrid columns="2" cellpadding="5">
					<h:outputLabel for="newPassword"
						value="#{msg['security']['newPassword']}" />
					<h:inputSecret id="newPassword"
						value="#{updatePasswordController.newPassword}"
						label="#{msg['security']['newPassword']}" size="12" maxlength="20"
						required="true" widgetVar="newPassword">
						<f:validateRegex pattern="\w{6,20}" />
					</h:inputSecret>

					<h:outputLabel for="newPasswordAgain"
						value="#{msg['security']['newPasswordAgain']}" />
					<h:inputSecret id="newPasswordAgain"
						value="#{updatePasswordController.newPasswordAgain}"
						label="#{msg['security']['newPasswordAgain']}" size="12"
						maxlength="20" required="true" widgetVar="newPasswordAgain">
						<f:validateRegex pattern="\w{6,20}" />
					</h:inputSecret>

					<p:spacer />
					<p:commandButton id="submitButton" value="#{msg['common']['save']}"
						actionListener="#{updatePasswordController.updatePassword}"
						update="@form :messages" onclick="if (!check()) {return false;}"
						icon="ui-icon-save1" />
				</h:panelGrid>
			</h:form>
		</p:panel>

		<script>
			function check() {
				var newPassword = document.getElementById("form:newPassword").value;
				var newPasswordAgain = document
						.getElementById("form:newPasswordAgain").value;
				if (newPassword != newPasswordAgain) {
					alert("#{msg['security']['twicePasswordsAreNotSame']}");
					return false;
				}
				return true;
			}
		</script>
	</ui:define>

</ui:composition>
